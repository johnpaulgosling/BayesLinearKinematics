<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to the BayesLinearKinematics package • BayesLinearKinematics</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to the BayesLinearKinematics package">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BayesLinearKinematics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.11</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/BayesLinearKinematics_intro.html">Introduction to the BayesLinearKinematics package</a></li>
    <li><a class="dropdown-item" href="../articles/HellingerDistances.html">Hellinger distances between belief specifications</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to the BayesLinearKinematics package</h1>
            
      

      <div class="d-none name"><code>BayesLinearKinematics_intro.Rmd</code></div>
    </div>

    
    
<p>This vignette assumes a basic understanding of statistical concepts
like expectation, variance, and covariance.</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>BayesLinearKinematics</code> package provides tools for
performing Bayes linear analysis. This involves representing uncertain
beliefs about quantities using expectation and covariance, and updating
these beliefs based on observed data or other uncertain information
(kinematics). This vignette demonstrates the core workflow: defining
prior beliefs, structuring observed data, performing adjustments, and
evaluating the result.</p>
<p>Note that this vignette was created using R version R version 4.5.1
(2025-06-13) and the <code>BayesLinearKinematics</code> package version
0.2.11.</p>
</div>
<div class="section level2">
<h2 id="defining-prior-beliefs-with-bl">1. Defining Prior Beliefs with <code>bl</code><a class="anchor" aria-label="anchor" href="#defining-prior-beliefs-with-bl"></a>
</h2>
<p>The foundation of a Bayes linear analysis is specifying your prior
beliefs about the variables of interest. This is done using the
<code>bl</code> class, which stores expectations and covariances.</p>
<p>Let’s define prior beliefs for three variables,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>.
We expect them to be 1, 2 and 3 respectively. We also specify their
covariance structure.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define prior beliefs using the bl() constructor</span></span>
<span><span class="va">bl_prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bl.html">bl</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'Prior Beliefs'</span>,        <span class="co"># A descriptive name for this belief set</span></span>
<span>               varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'x'</span>, <span class="st">'y'</span>, <span class="st">'z'</span><span class="op">)</span>,   <span class="co"># Names of the variables</span></span>
<span>               expectation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,      <span class="co"># Prior expected values E[x], E[y], E[z]</span></span>
<span>               covariance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="co"># Covariance matrix:</span></span>
<span>                                     <span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span>, <span class="co">#   [Var(x) Cov(y,x) Cov(z,x)]</span></span>
<span>                                     <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span><span class="op">)</span>,  <span class="co"># [Cov(x,y) Var(y) Cov(z,y)]</span></span>
<span>                                   nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="co">#[Cov(x,z) Cov(y,z) Var(z)]</span></span>
<span>              <span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the object - uses the custom print method defined for the 'bl' class</span></span>
<span><span class="co"># The 'digits' argument controls the rounding in the output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bl_prior</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Prior Beliefs </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Expectation:</span></span>
<span><span class="co">#&gt;    </span></span>
<span><span class="co">#&gt; x 1</span></span>
<span><span class="co">#&gt; y 2</span></span>
<span><span class="co">#&gt; z 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariance:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     x   y   z</span></span>
<span><span class="co">#&gt; x 1.0 0.5 0.2</span></span>
<span><span class="co">#&gt; y 0.5 1.0 0.5</span></span>
<span><span class="co">#&gt; z 0.2 0.5 1.0</span></span></code></pre></div>
<p>Essentially, here, we are encoding: <span class="math display">$$
\begin{align*}
\text{E}\pmatrix{x\\y\\z} &amp;= \pmatrix{1 \\ 2 \\ 3} \\
\text{Cov}\pmatrix{x\\y\\z} &amp;= \pmatrix{1.0 &amp; 0.5 &amp; 0.2 \\
0.5 &amp; 1.0 &amp; 0.5 \\ 0.2 &amp; 0.5 &amp; 1.0}
\end{align*}
$$</span></p>
<p>The <code>print</code> method gives a clean overview. We can also
visualise the covariance matrix using the <code>plot</code> method
defined for the <code>bl</code> class:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the covariance matrix using the S4 plot method for 'bl' objects</span></span>
<span><span class="co"># This method should handle the visualization details internally.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bl_prior</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="BayesLinearKinematics_intro_files/figure-html/plot_bl_prior-1.png" alt="Plot of the prior covariance matrix." width="672"><p class="caption">
Plot of the prior covariance matrix.
</p>
</div>
<p>This plot shows the strength and sign of the prior covariances
between variables. Red indicates positive covariance, blue negative
(though none here), and intensity relates to magnitude. The diagonal
elements represent the variances.</p>
</div>
<div class="section level2">
<h2 id="representing-observed-data-with-bl_data">2. Representing Observed Data with <code>bl_data</code><a class="anchor" aria-label="anchor" href="#representing-observed-data-with-bl_data"></a>
</h2>
<p>Suppose we observe values for some of the variables. We represent
this using the <code>bl_data</code> class. Let’s say we observed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
to be 1.1 and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
to be 2.1. For ease of exposition, we will denote these two observed
variables as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>
(for data).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define observed data using the bl_data() constructor</span></span>
<span><span class="va">observed_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bl_data.html">bl_data</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'Observations'</span>,      <span class="co"># A descriptive name for the data</span></span>
<span>                         varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'x'</span>, <span class="st">'y'</span><span class="op">)</span>,     <span class="co"># Names of the observed variables</span></span>
<span>                         values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.1</span>, <span class="fl">2.1</span><span class="op">)</span><span class="op">)</span>       <span class="co"># The observed values</span></span>
<span></span>
<span><span class="co"># Print the data object - uses the custom print method for 'bl_data'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">observed_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; Observations </span></span>
<span><span class="co">#&gt; Observed values:</span></span>
<span><span class="co">#&gt;      </span></span>
<span><span class="co">#&gt; x 1.1</span></span>
<span><span class="co">#&gt; y 2.1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="adjusting-beliefs-using-data-bl_adjust">3. Adjusting Beliefs using Data (<code>bl_adjust</code>)<a class="anchor" aria-label="anchor" href="#adjusting-beliefs-using-data-bl_adjust"></a>
</h2>
<p>The core operation is updating our prior beliefs
(<code>bl_prior</code>) using the <code>observed_data</code>. The
<code>bl_adjust</code> function performs this Bayes linear adjustment
according to the standard formulae: <span class="math display">$$
\begin{align*}
\text{E}_D\pmatrix{x\\y\\z} &amp;= \text{E}\pmatrix{x\\y\\z} +
\text{Cov}\left[\pmatrix{x\\y\\z} ,\pmatrix{x\\y}\right]\cdot
\text{Cov}\pmatrix{x\\y}^{-1} \cdot \left[D -
\text{E}\pmatrix{x\\y}\right]\\
\text{Cov}_D\pmatrix{x\\y\\z} &amp;= \text{Cov}\pmatrix{x\\y\\z} -
\text{Cov}\left[\pmatrix{x\\y\\z} ,\pmatrix{x\\y}\right]\cdot
\text{Cov}\pmatrix{x\\y}^{-1} \cdot \text{Cov}\left[\pmatrix{x\\y\\z}
,\pmatrix{x\\y}\right]^T.
\end{align*}
$$</span></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform the adjustment using the prior beliefs and the observed data</span></span>
<span><span class="co"># x: The 'bl' object containing prior beliefs to be adjusted.</span></span>
<span><span class="co"># y: The 'bl_data' object containing the observations to adjust by.</span></span>
<span><span class="va">bl_adjusted_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bl_adjust.html">bl_adjust</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bl_prior</span>, y <span class="op">=</span> <span class="va">observed_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the adjusted beliefs. Note the name is automatically generated.</span></span>
<span><span class="co"># Using more digits to see the effect of the adjustment.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bl_adjusted_data</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Prior Beliefs_adj_Observations </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Expectation:</span></span>
<span><span class="co">#&gt;        </span></span>
<span><span class="co">#&gt; x 1.100</span></span>
<span><span class="co">#&gt; y 2.100</span></span>
<span><span class="co">#&gt; z 3.047</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariance:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   x y     z</span></span>
<span><span class="co">#&gt; x 0 0 0.000</span></span>
<span><span class="co">#&gt; y 0 0 0.000</span></span>
<span><span class="co">#&gt; z 0 0 0.747</span></span></code></pre></div>
<p>Notice how the expectations for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
have changed from their prior values (1, 2, 3) based on the
observations. The covariance matrix has also been updated, reflecting
reduced uncertainty (variances on the diagonal are generally smaller).
Let’s plot the adjusted covariance:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the adjusted covariance matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bl_adjusted_data</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="BayesLinearKinematics_intro_files/figure-html/plot_bl_adjusted_data-1.png" alt="Plot of the covariance matrix after adjustment with data." width="672"><p class="caption">
Plot of the covariance matrix after adjustment with data.
</p>
</div>
<p>Comparing this plot to the prior covariance plot, we can see changes,
particularly a reduction in the variance (diagonal elements) and
potentially changes in the off-diagonal covariances, reflecting the
information gained from the data.</p>
</div>
<div class="section level2">
<h2 id="adjusting-beliefs-using-kinematics-bl_adjust">4. Adjusting Beliefs using Kinematics (<code>bl_adjust</code>)<a class="anchor" aria-label="anchor" href="#adjusting-beliefs-using-kinematics-bl_adjust"></a>
</h2>
<p>The <code>bl_adjust</code> function can also update one set of
beliefs (<code>bl</code> object, <code>x</code>) based on another set of
related beliefs (<code>bl</code> object, <code>y</code>). This is
sometimes referred to as Bayes linear kinematics. It uses similar
formulae but incorporates the uncertainty from the second belief object
(<code>y</code>).</p>
<p>Let’s define a second belief structure, perhaps representing
information about
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
from another source (e.g., a different sensor or expert opinion).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define a second set of beliefs (e.g., from another expert or model)</span></span>
<span><span class="va">bl_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bl.html">bl</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Sensor Info"</span>,</span>
<span>              varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'y'</span>, <span class="st">'z'</span><span class="op">)</span>,          <span class="co"># Variables covered by this info</span></span>
<span>              expectation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.2</span>, <span class="fl">2.8</span><span class="op">)</span>,      <span class="co"># Expectations from this source</span></span>
<span>              covariance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="co"># Covariance structure from this source</span></span>
<span>                                    <span class="fl">0.1</span>, <span class="fl">0.6</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bl_info</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sensor Info </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Expectation:</span></span>
<span><span class="co">#&gt;      </span></span>
<span><span class="co">#&gt; y 2.2</span></span>
<span><span class="co">#&gt; z 2.8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariance:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     y   z</span></span>
<span><span class="co">#&gt; y 0.5 0.1</span></span>
<span><span class="co">#&gt; z 0.1 0.6</span></span></code></pre></div>
<p>Now, we adjust our original <code>bl_prior</code> using this
<code>bl_info</code>. The adjustment combines the information from both
sources.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform kinematic adjustment</span></span>
<span><span class="co"># x: The 'bl' object containing prior beliefs to be adjusted.</span></span>
<span><span class="co"># y: The 'bl' object containing the other beliefs to adjust by.</span></span>
<span><span class="va">bl_adjusted_kinematics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bl_adjust.html">bl_adjust</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bl_prior</span>, y <span class="op">=</span> <span class="va">bl_info</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the result of the kinematic adjustment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bl_adjusted_kinematics</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Prior Beliefs_adj_Sensor Info </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Expectation:</span></span>
<span><span class="co">#&gt;       </span></span>
<span><span class="co">#&gt; x 1.12</span></span>
<span><span class="co">#&gt; y 2.20</span></span>
<span><span class="co">#&gt; z 2.80</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariance:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       x    y     z</span></span>
<span><span class="co">#&gt; x 0.884 0.26 0.013</span></span>
<span><span class="co">#&gt; y 0.260 0.50 0.100</span></span>
<span><span class="co">#&gt; z 0.013 0.10 0.600</span></span>
<span></span>
<span><span class="co"># Plot the resulting covariance after kinematic adjustment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bl_adjusted_kinematics</span><span class="op">)</span></span></code></pre></div>
<p><img src="BayesLinearKinematics_intro_files/figure-html/adjust_beliefs_kinematics-1.png" width="672"></p>
<p>The adjustment incorporates the information from <code>bl_info</code>
into the prior beliefs, updating both expectations and covariances
according to Bayes linear rules for combining uncertain information.</p>
</div>
<div class="section level2">
<h2 id="calculating-resolution-with-bl_resolution">5. Calculating Resolution with <code>bl_resolution</code><a class="anchor" aria-label="anchor" href="#calculating-resolution-with-bl_resolution"></a>
</h2>
<p>How much has our uncertainty been reduced by an adjustment? The
<code>bl_resolution</code> function calculates this, comparing the prior
variance to the adjusted variance for each variable:
<code>Resolution = 1 - Var_adjusted / Var_prior</code>. This applies
when comparing a prior <code>bl</code> object (<code>x</code>) to an
adjusted <code>bl</code> object (<code>y</code>).</p>
<p>Let’s calculate the resolution achieved by the data adjustment
performed earlier:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate the resolution comparing the prior to the data-adjusted beliefs</span></span>
<span><span class="co"># x: The 'bl' object representing prior beliefs.</span></span>
<span><span class="co"># y: The 'bl' object representing adjusted beliefs.</span></span>
<span><span class="va">resolution_values_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bl_resolution.html">bl_resolution</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bl_prior</span>, y <span class="op">=</span> <span class="va">bl_adjusted_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the resolutions, rounded for clarity</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">resolution_values_data</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     x     y     z </span></span>
<span><span class="co">#&gt; 1.000 1.000 0.253</span></span></code></pre></div>
<p>A resolution close to 1 means the variance for that variable was
greatly reduced by the adjustment, while a value close to 0 means the
adjustment had little impact on its variance. Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
(the observed variables) have higher resolution, indicating their
variance decreased significantly.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
also has some resolution, reflecting the information gained about it
indirectly through its covariance with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>.</p>
<p>We can also calculate the resolution resulting from the kinematic
adjustment:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate the resolution comparing the prior to the kinematically-adjusted beliefs</span></span>
<span><span class="va">resolution_values_kinematics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bl_resolution.html">bl_resolution</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bl_prior</span>, y <span class="op">=</span> <span class="va">bl_adjusted_kinematics</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the resolutions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">resolution_values_kinematics</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     x     y     z </span></span>
<span><span class="co">#&gt; 0.116 0.500 0.400</span></span></code></pre></div>
<p>This shows the variance reduction achieved by combining the
<code>bl_prior</code> with <code>bl_info</code>.</p>
</div>
<div class="section level2">
<h2 id="subsetting-beliefs-with-bl_subset">6. Subsetting Beliefs with <code>bl_subset</code><a class="anchor" aria-label="anchor" href="#subsetting-beliefs-with-bl_subset"></a>
</h2>
<p>Sometimes you might want to focus on a subset of variables from a
<code>bl</code> or <code>bl_data</code> object. The
<code>bl_subset</code> function allows this, extracting the relevant
expectations, values, and sub-matrices of the covariance.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract beliefs only for 'x' and 'z' from the data-adjusted object</span></span>
<span><span class="co"># x: The 'bl' or 'bl_data' object to subset.</span></span>
<span><span class="co"># varnames: A character vector of variable names to keep.</span></span>
<span><span class="va">bl_subset_xz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bl_subset.html">bl_subset</a></span><span class="op">(</span><span class="va">bl_adjusted_data</span>, varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'x'</span>, <span class="st">'z'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bl_subset_xz</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Prior Beliefs_adj_Observations_extract </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Expectation:</span></span>
<span><span class="co">#&gt;        </span></span>
<span><span class="co">#&gt; x 1.100</span></span>
<span><span class="co">#&gt; z 3.047</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariance:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   x     z</span></span>
<span><span class="co">#&gt; x 0 0.000</span></span>
<span><span class="co">#&gt; z 0 0.747</span></span>
<span></span>
<span><span class="co"># Extract data only for 'x' from the original observations</span></span>
<span><span class="co"># (This is a simple case but demonstrates subsetting bl_data)</span></span>
<span><span class="va">data_subset_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bl_subset.html">bl_subset</a></span><span class="op">(</span><span class="va">observed_data</span>, varnames <span class="op">=</span> <span class="st">'x'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">data_subset_x</span><span class="op">)</span></span>
<span><span class="co">#&gt; Observations_extract </span></span>
<span><span class="co">#&gt; Observed values:</span></span>
<span><span class="co">#&gt;      </span></span>
<span><span class="co">#&gt; x 1.1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>This vignette demonstrated the basic use of the
<code>BayesLinearKinematics</code> package:</p>
<ol style="list-style-type: decimal">
<li>Create prior beliefs using <code><a href="../reference/bl.html">bl()</a></code>.</li>
<li>Represent observations using <code><a href="../reference/bl_data.html">bl_data()</a></code>.</li>
<li>Update beliefs using observations or other beliefs via
<code><a href="../reference/bl_adjust.html">bl_adjust()</a></code>.</li>
<li>Evaluate the information gained (variance reduction) using
<code><a href="../reference/bl_resolution.html">bl_resolution()</a></code>.</li>
<li>Extract subsets of variables using <code><a href="../reference/bl_subset.html">bl_subset()</a></code>.</li>
</ol>
<p>These tools provide a foundation for applying Bayes linear methods in
R. Remember to consult the help files (e.g., <code><a href="../reference/bl.html">?bl</a></code>,
<code><a href="../reference/bl_adjust.html">?bl_adjust</a></code>) for further details on each function and its
arguments.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by John Paul Gosling.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
