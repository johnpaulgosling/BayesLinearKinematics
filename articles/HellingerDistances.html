<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Hellinger distances between belief specifications • BayesLinearKinematics</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Hellinger distances between belief specifications">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BayesLinearKinematics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.12</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/BayesLinearKinematics_intro.html">Introduction to the BayesLinearKinematics package</a></li>
    <li><a class="dropdown-item" href="../articles/HellingerDistances.html">Hellinger distances between belief specifications</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Hellinger distances between belief specifications</h1>
            
      

      <div class="d-none name"><code>HellingerDistances.Rmd</code></div>
    </div>

    
    
<p>This vignette assumes familiarity with the <code>bl</code> object
class introduced in the “Introduction to the
<code>BayesLinearKinematics</code> package” vignette.</p>
<p>Note that this vignette was created using R version R version 4.5.1
(2025-06-13) and the <code>BayesLinearKinematics</code> package version
0.2.12.</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In Bayes linear analysis, we represent beliefs using expectations and
covariances. Sometimes, we want to quantify how “different” two belief
specifications are. The Hellinger distance is a metric used to measure
the similarity between two probability distributions. While a
<code>bl</code> object only stores the first two moments (expectation
and covariance), we can calculate the Hellinger distance between the
multivariate normal distributions that share these moments. This
provides a useful measure of discrepancy between two belief
specifications encapsulated in <code>bl</code> objects.</p>
<p>The squared Hellinger distance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>H</mi><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mo>,</mo><mi>Q</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">H^2(P, Q)</annotation></semantics></math>
ranges between 0 and 1 where 0 indicates the distributions (and thus the
expectations and covariances) are identical and 1 indicates maximal
difference.</p>
<p>This vignette demonstrates how to use the
<code><a href="../reference/hellinger_squared.html">hellinger_squared()</a></code> function in the
<code>BayesLinearKinematics</code> package to calculate this
distance.</p>
</div>
<div class="section level2">
<h2 id="defining-the-squared-hellinger-distance-normal-case">Defining the Squared Hellinger Distance (Normal Case)<a class="anchor" aria-label="anchor" href="#defining-the-squared-hellinger-distance-normal-case"></a>
</h2>
<p>The <code><a href="../reference/hellinger_squared.html">hellinger_squared()</a></code> function calculates the distance
between two <code>bl</code> objects <code>x</code> and <code>y</code> by
assuming they represent multivariate normal distributions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Q</mi><annotation encoding="application/x-tex">Q</annotation></semantics></math>
respectively with means
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>μ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\mu_1, \mu_2</annotation></semantics></math>
(from <code>x@expectation</code>, <code>y@expectation</code>) and
covariance matrices
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Σ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Σ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\Sigma_1, \Sigma_2</annotation></semantics></math>
(from <code>x@covariance</code>, <code>y@covariance</code>).</p>
<p>Univariate Case: If the <code>bl</code> objects represent beliefs
about a single variable
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>=</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>,</mo><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P = N(\mu_1, \sigma_1^2)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo>=</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mn>2</mn></msub><mo>,</mo><msubsup><mi>σ</mi><mn>2</mn><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Q = N(\mu_2, \sigma_2^2)</annotation></semantics></math>),
the squared Hellinger distance is:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>H</mi><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mo>,</mo><mi>Q</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>−</mo><msqrt><mfrac><mrow><mn>2</mn><msub><mi>σ</mi><mn>1</mn></msub><msub><mi>σ</mi><mn>2</mn></msub></mrow><mrow><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mn>2</mn><mn>2</mn></msubsup></mrow></mfrac></msqrt><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mfrac><mn>1</mn><mn>4</mn></mfrac><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>−</mo><msub><mi>μ</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mn>2</mn><mn>2</mn></msubsup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">H^2(P, Q) = 1 - \sqrt{\frac{2 \sigma_1 \sigma_2}{\sigma_1^2 + \sigma_2^2}} \exp\left(-\frac{1}{4} \frac{(\mu_1 - \mu_2)^2}{\sigma_1^2 + \sigma_2^2}\right)</annotation></semantics></math></p>
<p>Multivariate Case: If the <code>bl</code> objects represent beliefs
about multiple variables
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>=</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Σ</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P = N(\mu_1, \Sigma_1)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo>=</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mn>2</mn></msub><mo>,</mo><msub><mi>Σ</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Q = N(\mu_2, \Sigma_2)</annotation></semantics></math>),
the squared Hellinger distance is:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>H</mi><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mo>,</mo><mi>Q</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mrow><mo>det</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Σ</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mn>1</mn><mi>/</mi><mn>4</mn></mrow></msup><mo>det</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Σ</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mn>1</mn><mi>/</mi><mn>4</mn></mrow></msup></mrow><mrow><mo>det</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msub><mi>Σ</mi><mn>1</mn></msub><mo>+</mo><msub><mi>Σ</mi><mn>2</mn></msub></mrow><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msup></mrow></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mfrac><mn>1</mn><mn>8</mn></mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>−</mo><msub><mi>μ</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msub><mi>Σ</mi><mn>1</mn></msub><mo>+</mo><msub><mi>Σ</mi><mn>2</mn></msub></mrow><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>−</mo><msub><mi>μ</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">H^2(P, Q) = 1 - \frac{\det(\Sigma_1)^{1/4} \det(\Sigma_2)^{1/4}}{\det\left(\frac{\Sigma_1 + \Sigma_2}{2}\right)^{1/2}} \exp\left(-\frac{1}{8} (\mu_1 - \mu_2)^T \left(\frac{\Sigma_1 + \Sigma_2}{2}\right)^{-1} (\mu_1 - \mu_2)\right)</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>det</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\det(\cdot)</annotation></semantics></math>
denotes the determinant of a matrix and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><annotation encoding="application/x-tex">(\cdot)^{-1}</annotation></semantics></math>
denotes the matrix inverse (or generalised inverse ginv as used in the
function for numerical stability).</p>
</div>
<div class="section level2">
<h2 id="calculating-distance-between-two-belief-specifications">Calculating Distance Between Two Belief Specifications<a class="anchor" aria-label="anchor" href="#calculating-distance-between-two-belief-specifications"></a>
</h2>
<p>Let’s define two different belief specifications for the same set of
variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>.
We can then use hellinger_squared() to quantify how much these beliefs
differ.</p>
<p>First, we define belief_A perhaps representing an initial
assessment.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define first belief specification</span></span>
<span><span class="va">belief_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bl.html">bl</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Belief A"</span>,</span>
<span>  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span>,</span>
<span>  expectation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  covariance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="fl">1.0</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span>,</span>
<span>      <span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span>,</span>
<span>      <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span></span>
<span>    <span class="op">)</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">belief_A</span></span>
<span><span class="co">#&gt; Belief A </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Expectation:</span></span>
<span><span class="co">#&gt;    </span></span>
<span><span class="co">#&gt; x 1</span></span>
<span><span class="co">#&gt; y 2</span></span>
<span><span class="co">#&gt; z 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariance:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     x   y   z</span></span>
<span><span class="co">#&gt; x 1.0 0.5 0.2</span></span>
<span><span class="co">#&gt; y 0.5 1.0 0.5</span></span>
<span><span class="co">#&gt; z 0.2 0.5 1.0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">belief_A</span><span class="op">)</span></span></code></pre></div>
<p><img src="HellingerDistances_files/figure-html/unnamed-chunk-1-1.png" width="672"></p>
<p>Now, we define <code>belief_B</code> representing an alternative
assessment perhaps from a different expert or model.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define second belief specification (different expectation and covariance)</span></span>
<span><span class="va">belief_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bl.html">bl</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Belief B"</span>,</span>
<span>  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span>,</span>
<span>  expectation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">2.1</span>, <span class="fl">2.9</span><span class="op">)</span>, <span class="co"># Slightly different means</span></span>
<span>  covariance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="fl">1.1</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="co"># Slightly different covariance</span></span>
<span>      <span class="fl">0.4</span>, <span class="fl">0.9</span>, <span class="fl">0.6</span>,</span>
<span>      <span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="fl">1.2</span></span>
<span>    <span class="op">)</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">belief_B</span></span>
<span><span class="co">#&gt; Belief B </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Expectation:</span></span>
<span><span class="co">#&gt;      </span></span>
<span><span class="co">#&gt; x 1.2</span></span>
<span><span class="co">#&gt; y 2.1</span></span>
<span><span class="co">#&gt; z 2.9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariance:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     x   y   z</span></span>
<span><span class="co">#&gt; x 1.1 0.4 0.3</span></span>
<span><span class="co">#&gt; y 0.4 0.9 0.6</span></span>
<span><span class="co">#&gt; z 0.3 0.6 1.2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">belief_B</span><span class="op">)</span></span></code></pre></div>
<p><img src="HellingerDistances_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<p>Now, we calculate the squared Hellinger distance between
<code>belief_A</code> and <code>belief_B</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate the squared Hellinger distance</span></span>
<span><span class="co"># x: The first 'bl' object.</span></span>
<span><span class="co"># y: The second 'bl' object.</span></span>
<span><span class="va">dist_A_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hellinger_squared.html">hellinger_squared</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">belief_A</span>, y <span class="op">=</span> <span class="va">belief_B</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span>
<span>  <span class="st">"Squared Hellinger distance between Belief A and Belief B:"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">dist_A_B</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Squared Hellinger distance between Belief A and Belief B: 0.0182</span></span></code></pre></div>
<p>The resulting value (likely small but non-zero) quantifies the
difference between these two belief specifications under the normality
assumption. A value closer to 0 indicates higher similarity.</p>
<p>Let’s also quickly check the univariate case.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Univariate beliefs</span></span>
<span><span class="va">belief_X1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bl.html">bl</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"X1"</span>, varnames <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                expectation <span class="op">=</span> <span class="fl">1</span>, covariance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">belief_X2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bl.html">bl</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"X2"</span>, varnames <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                expectation <span class="op">=</span> <span class="fl">1.5</span>, covariance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dist_X1_X2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hellinger_squared.html">hellinger_squared</a></span><span class="op">(</span><span class="va">belief_X1</span>, <span class="va">belief_X2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span>
<span>  <span class="st">"Squared Hellinger distance between Belief X1 and Belief X2:"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">dist_X1_X2</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Squared Hellinger distance between Belief X1 and Belief X2: 0.03</span></span>
<span></span>
<span><span class="co"># Check distance to self (should be 0)</span></span>
<span><span class="va">dist_X1_X1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hellinger_squared.html">hellinger_squared</a></span><span class="op">(</span><span class="va">belief_X1</span>, <span class="va">belief_X1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span>
<span>  <span class="st">"\nSquared Hellinger distance between Belief X1 and itself:"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">dist_X1_X1</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Squared Hellinger distance between Belief X1 and itself: 0</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="measuring-the-impact-of-kinematic-adjustment">Measuring the Impact of Kinematic Adjustment<a class="anchor" aria-label="anchor" href="#measuring-the-impact-of-kinematic-adjustment"></a>
</h2>
<p>The Hellinger distance can also be used to measure how much a belief
specification changes after undergoing a Bayes linear adjustment
(kinematics). We can calculate the distance between the prior beliefs
and the adjusted beliefs.</p>
<p>Let’s reuse the prior beliefs (<code>bl_prior</code>) and the
kinematic information (<code>bl_info</code>) from the introductory
vignette examples.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define prior beliefs (same as intro vignette)</span></span>
<span><span class="va">bl_prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bl.html">bl</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Prior Beliefs"</span>,</span>
<span>  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span>,</span>
<span>  expectation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  covariance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="fl">1.0</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span>,</span>
<span>      <span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span>,</span>
<span>      <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span></span>
<span>    <span class="op">)</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define kinematic information (same as intro vignette)</span></span>
<span><span class="va">bl_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bl.html">bl</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Info"</span>,</span>
<span>  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span>,</span>
<span>  expectation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.2</span>, <span class="fl">2.8</span><span class="op">)</span>,</span>
<span>  covariance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">0.5</span>, <span class="fl">0.1</span>,</span>
<span>    <span class="fl">0.1</span>, <span class="fl">0.6</span></span>
<span>  <span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform the kinematic adjustment</span></span>
<span><span class="va">bl_adjusted_kinematics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bl_adjust.html">bl_adjust</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bl_prior</span>, y <span class="op">=</span> <span class="va">bl_info</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Quick look at the prior and adjusted beliefs</span></span>
<span><span class="va">bl_prior</span></span>
<span><span class="co">#&gt; Prior Beliefs </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Expectation:</span></span>
<span><span class="co">#&gt;    </span></span>
<span><span class="co">#&gt; x 1</span></span>
<span><span class="co">#&gt; y 2</span></span>
<span><span class="co">#&gt; z 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariance:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     x   y   z</span></span>
<span><span class="co">#&gt; x 1.0 0.5 0.2</span></span>
<span><span class="co">#&gt; y 0.5 1.0 0.5</span></span>
<span><span class="co">#&gt; z 0.2 0.5 1.0</span></span>
<span><span class="va">bl_adjusted_kinematics</span></span>
<span><span class="co">#&gt; Prior Beliefs_adj_Info </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Expectation:</span></span>
<span><span class="co">#&gt;       </span></span>
<span><span class="co">#&gt; x 1.12</span></span>
<span><span class="co">#&gt; y 2.20</span></span>
<span><span class="co">#&gt; z 2.80</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariance:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      x    y    z</span></span>
<span><span class="co">#&gt; x 0.88 0.26 0.01</span></span>
<span><span class="co">#&gt; y 0.26 0.50 0.10</span></span>
<span><span class="co">#&gt; z 0.01 0.10 0.60</span></span></code></pre></div>
<p>Now, we calculate the squared Hellinger distance between the prior
belief (<code>bl_prior</code>) and the belief state after adjustment
(<code>bl_adjusted_kinematics</code>). Note that <code>bl_adjust</code>
might only adjust a subset of variables if <code>bl_info</code> covers
fewer variables than <code>bl_prior</code>.
<code>hellinger_squared</code> requires both inputs to cover the same
set of variables. We should calculate the distance over the variables
common to both stages after adjustment i.e. the variables present in
<code>bl_adjusted_kinematics</code>. In this specific case,
<code>bl_adjust</code> preserves all variables from
<code>bl_prior</code> so we can compare them directly.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot prior covariance</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bl_prior</span><span class="op">)</span></span></code></pre></div>
<p><img src="HellingerDistances_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Plot adjusted covariance</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bl_adjusted_kinematics</span><span class="op">)</span></span></code></pre></div>
<p><img src="HellingerDistances_files/figure-html/unnamed-chunk-6-2.png" width="672"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Calculate squared Hellinger distance between prior and adjusted beliefs</span></span>
<span><span class="va">dist_kinematic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hellinger_squared.html">hellinger_squared</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bl_prior</span>,</span>
<span>                                    y <span class="op">=</span> <span class="va">bl_adjusted_kinematics</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span>
<span>  <span class="st">"\nSquared Hellinger distance between Prior and Adjusted (Kinematic):"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">dist_kinematic</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Squared Hellinger distance between Prior and Adjusted (Kinematic): 0.0637</span></span></code></pre></div>
<p>This distance quantifies the magnitude of the belief change induced
by the kinematic update from <code>bl_info</code>. A larger value
implies the kinematic information caused a greater shift in the belief
state (mean and/or covariance structure) under the normality
assumption.</p>
</div>
<div class="section level2">
<h2 id="function-notes">Function Notes<a class="anchor" aria-label="anchor" href="#function-notes"></a>
</h2>
<p>The <code>hellinger_squared</code> function includes several
checks:</p>
<ul>
<li>It ensures both inputs (x and y) are <code>bl</code> objects.</li>
<li>It verifies that both <code>bl</code> objects contain the exact same
set of variable names (<code>varnames</code>).</li>
<li>It internally reorders the second object (y) to match the variable
order of the first object (<code>x</code>) using <code>bl_subset</code>
before performing calculations ensuring alignment.</li>
</ul>
<p>If these conditions are not met, the function will stop and return an
informative error message.</p>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>This vignette demonstrated the use of the hellinger_squared()
function to compute a measure of distance between two belief
specifications (bl objects) based on their corresponding multivariate
normal distributions.</p>
<ul>
<li>We reviewed the formulae used for univariate and multivariate
cases.</li>
<li>We calculated the distance between two distinct <code>bl</code>
objects (<code>belief_A</code> and <code>belief_B</code>).</li>
<li>We calculated the distance between a prior belief
(<code>bl_prior</code>) and its state after a kinematic update
(<code>bl_adjusted_kinematics</code>) to quantify the impact of the
adjustment.</li>
</ul>
<p>The squared Hellinger distance provides a value between 0 and 1
offering a standardised way to compare belief structures or measure the
effect of belief updates within the <code>BayesLinearKinematics</code>
framework assuming normality based on the first two moments.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by John Paul Gosling.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
